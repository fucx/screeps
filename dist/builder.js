// Generated by CoffeeScript 1.9.3
(function() {
  module.exports = function(creep) {
    var damagedRamparts, damagedStructures, site, spawn;
    if (creep.carry.energy > 0) {
      damagedRamparts = creep.room.find(FIND_MY_STRUCTURES, {
        filter: function(object) {
          return (object.structureType === STRUCTURE_RAMPART) && (object.hits < object.hitsMax - 50);
        }
      });
      damagedRamparts.sort(function(a, b) {
        return a.hits - b.hits;
      });
      if (damagedRamparts.length) {
        creep.moveTo(damagedRamparts[0]);
        creep.repair(damagedRamparts[0]);
        return;
      }
      damagedStructures = creep.room.find(FIND_MY_STRUCTURES, {
        filter: function(object) {
          return object.hits < object.hitsMax / 2;
        }
      });
      damagedStructures.sort(function(a, b) {
        return a.hits - b.hits;
      });
      if (damagedStructures.length) {
        creep.moveTo(damagedStructures[0]);
        creep.repair(damagedStructures[0]);
        return;
      }
      site = creep.pos.findClosest(FIND_CONSTRUCTION_SITES);
      if (site) {
        creep.moveTo(site);
        return creep.build(site);
      }
    } else {
      spawn = creep.pos.findClosest(FIND_MY_SPAWNS);
      creep.moveTo(spawn);
      return spawn.transferEnergy(creep);
    }
  };

}).call(this);
